/**
 * DrawText.java
 * © MINETUR, Government of Spain
 * This program is part of LocalGIS
 * This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 2 of the License, or (at your option) any later version.
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 * You should have received a copy of the GNU General Public License along with this program. If not, see <http://www.gnu.org/licenses/>.
 */
/*
 *
 * Este codigo se distribuye bajo licencia GPL
 * de GNU. Para obtener una cópia integra de esta
 * licencia acude a www.gnu.org.
 * 
 * Este software se distribuye "como es". AGIL
 * solo  pretende desarrollar herramientas para
 * la promoción del GIS Libre.
 * AGIL no se responsabiliza de las perdidas económicas o de 
 * información derivadas del uso de este software.
 */

package org.agil.dxf;

import java.awt.Color;
import java.awt.Graphics;
import java.text.StringCharacterIterator;

import org.agil.dxf.math.Matrix4D;
import org.agil.dxf.math.Point3D;
import org.agil.dxf.math.Vector3D;
import org.agil.dxf.reader.DxfException;
import org.agil.dxf.reader.DxfFile;
import org.agil.dxf.reader.DxfHeader;
import org.agil.dxf.reader.DxfLAYER;
import org.agil.dxf.reader.DxfTEXT;



/**
 *  DrawAble of a DXF text.
 */
public class DrawText extends DrawSet implements Cloneable {
  static private final boolean CREATE_CONNECTIONS = true;
  static private final char    UNDERLINE    = 0x0001,
                               OVERLINE     = 0x0002;
  static private final char    SC_PLUSMINUS = (char)241,
                               SC_DIAMETER  = (char)237,
                               SC_DEGREE    = (char)248;
  private Matrix4D              trafo;
  private DrawChar[]            drawChars = null;
  private Point3D               min,
                                max;
  private int                   nrLines = 0;


  /**
   *  Create an empty DrawText.
   */
  private DrawText() {
  }

  /**
   *  Create a drawable representation of a DXF text.
   *  @param  mat         additional transformation (maybe <code>null</code>)
   *  @param  dxftext     the DXF TEXT entity
   *  @param  dxf         the DXF file for STYLE lookup
   *  @param  fontFinder  class which can locate fonts
   *  @exception DxfException when there is no font found
   */
  public DrawText(Matrix4D mat, DxfTEXT dxftext, DxfFile dxf, FontFinder fontFinder) throws DxfException {
    super(mat);

    String text = dxftext.getText();
    if (text != null   &&   text.length() > 0) {
      StringCharacterIterator it = new StringCharacterIterator(text);
      StringBuffer out = new StringBuffer();

      int[] underline = new int[text.length()];

      // --- substitute special chars ---
      for (char c = it.first();   c != StringCharacterIterator.DONE;   c = it.next()) {
	if (c == '%') {
	  c = it.next();
	  if (c != '%') {
	    out.append('%');
	    c = it.previous();
	    continue;
	  }

	  c = it.next();
	  switch (c) {
	  case '%': // %%% = percent sign
	    out.append('%');
	    break;

	  case 'p': // %%p = plus/minus
	  case 'P':
	    out.append(SC_PLUSMINUS);
	    break;

	  case 'c': // %%c = diameter
	  case 'C':
	    out.append(SC_DIAMETER);
	    break;

	  case 'd': // %%d = degree sign
	  case 'D':
	    out.append(SC_DEGREE);
	    break;

	  case 'u': // toggle underline
	  case 'U':
	    underline[out.length()] ^= UNDERLINE;
	    break;

	  case 'o': // toggle overline
	  case 'O':
	    underline[out.length()] ^= OVERLINE;
	    break;

	  default:
	    if (c >= '0'   &&   c <= '9') { // letter in form %%###
	      int max_digits = 3;
	      char letter = (char)(c - '0');

	      c = it.next();
	      while ((c >= '0'   &&   c <= '9')   &&   --max_digits > 0) {
		letter = (char)(10*letter + (c - '0'));
		c = it.next();
	      }
	      out.append(letter);
	    }
	    c = it.previous();
	  }
	}
	else if (c == '^') {  // skip control chars
	  c = it.next();
	  if (c == ' ') {
	    out.append('^');
	  }
	}
	else {
	  out.append(c);
	}
      }

      // --- Font ---
      DxfFont font = fontFinder.getFont(dxf.getStyle(dxftext.getStyleName()).getFontName());

      // --- get drawable chars from font ---
      text = Unicode.char2DOS437(out, dxf.getCodePage(), '?');

      int lining = 0;
      int line   = 0;
      int pos    = 0;
      it = new StringCharacterIterator(text);
      for (char c = it.first();   c != StringCharacterIterator.DONE;   c = it.next()) {
	if (drawChars == null) {
	  drawChars = new DrawChar[1];
	}
	else {
	  DrawChar[] newChars = new DrawChar[drawChars.length+1];
	  System.arraycopy(drawChars, 0, newChars, 0, drawChars.length);
	  drawChars = newChars;
	}

	drawChars[pos++] = font.getDrawChar(c);
      }

      // === calc bounding box ===
      min = new Point3D(1e8f, 1e8f, 1e8f);
      max = new Point3D(-1e8f, -1e8f, -1e8f);
      double offsetX = 0,
	offsetY = 0;

      Matrix4D translate = new Matrix4D();
      for (pos = 0;   pos < drawChars.length;   pos++) {
	drawChars[pos].calcBB(min, max, translate);
	translate.translate(drawChars[pos].advance, 0, 0);
	nrLines += drawChars[pos].nrLines;
      }

      // === calc trafos ===
      // --- scale/slant ---
      double scale = dxftext.getTextHeight();
      trafo = new Matrix4D(scale*dxftext.getAspectRatio(), scale*dxftext.getSlant(), 0, 0,
			   0, scale, 0, 0,
			   0, 0,     1, 0,
			   0, 0, 0,     1);

      // --- mirror ---
      short mirrorflags = dxftext.getMirror();
      if (mirrorflags != (short)0) {
	Matrix4D mirror = new Matrix4D((mirrorflags & DxfTEXT.MIRROR_X) != 0  ?  -1  :  1, 0, 0, 0,
				       0, (mirrorflags & DxfTEXT.MIRROR_Y) != 0  ?  -1  :  1, 0, 0,
				       0, 0, 1, 0,
				       0, 0, 0, 1);
	trafo.multLeftBy(mirror);
      }
      // --- rotate ---
      trafo.zrot(dxftext.getRotation());

      // --- translate ---
      Point3D insert = dxftext.getPosition();
      trafo.translateLeft(insert.x, insert.y, insert.z);


      /* --- !!! forget extrusion for the first --- */
      /* --- rotate in z --- */
      mat = dxftext.calcArbitMat();
      if (mat != null) {
	trafo.multLeftBy(mat);
      }

    }
  }

  /**
   *  Draw everything.
   *  @param  g           the graphics context
   *  @param  mat         transformation matrix
   *  @param  insLayer    layer set in the last INSERT (maybe null)
   *  @param  insColor    the color set in the last INSERT
   */
  public void draw(Graphics g, Matrix4D mat, DxfLAYER insLayer,
		   DxfColorModel colorModel, short insColor) {
    if (!isVisible(insLayer)) {
      return;
    }
    if (drawChars != null   &&  drawChars.length > 0) {
      Color drawColor = colorModel.getColor(calcColor(insColor, insLayer));
      Matrix4D tmp;

      if (mat != null) {
	tmp = mat.mult(trafo);
      }
      else {
	tmp = new Matrix4D(trafo);
      }

      int c;
      for (c = 0;   c < drawChars.length-1;   c++) {
	drawChars[c].draw(g, tmp, drawColor);
	tmp.translate(drawChars[c].advance, 0, 0);
      }
      // last char
      drawChars[c].draw(g, tmp, drawColor);
    }
  }

  /**
   *  Draw reduced.
   *  @param  g           the graphics context
   *  @param  mat         transformation matrix
   *  @param  insLayer    layer set in the last INSERT (maybe null)
   *  @param  insColor    the color set in the last INSERT
   *  @param  nr          counter to see wether we draw or not (draw if nr==0)
   *  @param  maxNr       reducing
   */
  public void draw(Graphics g, Matrix4D mat, DxfLAYER insLayer,
		   DxfColorModel colorModel, short insColor, int nr, int maxNr) {
    // dont draw
  }

  /**
   *  Calculate the bounding box and the number of lines.
   *  @param  min         minimal corner so far
   *  @param  max         maximal corner so far
   *  @param  mat         transformation matrix
   *  @param  insLayer    layer set in the last INSERT (maybe null)
   *  @param  onlyVisible if <code>true</code> use only elements on
   *                      visible layers for the calculation
   *  @return number of lines
   */
  public int calcBB(Point3D min, Point3D max, Matrix4D mat,
		    DxfLAYER insertLayer, boolean onlyVisible) {
    if (drawChars != null   &&   drawChars.length > 0) {
      Point3D  p;
      Matrix4D tmp;

      if (mat == null) {
	tmp = trafo;
      }
      else {
	tmp = mat.mult(trafo);
      }


      Point3D[] corner = new Point3D[4];
      /* southwest */
      corner[0] = this.min;
      /* southeast */
      corner[1] = new Point3D(this.max.x, this.min.y, 0);
      /* northwest */
      corner[2] = new Point3D(this.min.x, this.max.y, 0);
      /* norteast */
      corner[3] = this.max;

      for (int c = 0;   c < 4;   c++) {
	p = tmp.mult(corner[c]);

	if (p.x < min.x) {
	  min.x = p.x;
	}
	if (p.x > max.x) {
	  max.x = p.x;
	}
	if (p.y < min.y) {
	  min.y = p.y;
	}
	if (p.y > max.y) {
	  max.y = p.y;
	}
	if (p.z < min.z) {
	  min.z = p.z;
	}
	if (p.z > max.z) {
	  max.z = p.z;
	}
      }
    }

    return nrLines;
  }

  /**
   *  Transform this element.
   *  @param  mat         trabnsformation matrix
   */
  public void transformBy(Matrix4D mat) {
    trafo.multLeftBy(mat);
  }



  /**
   *  Extrude in arbitrary direction. Just create a second text in the correct
   *  distance.
   *  <p>
   *  If the static final variable <code>CREATE_CONNECTIONS</code> is set
   *  to <code>true</code>, there are connections created between the two
   *  texts. If not, there are no connections created which saves a lot of
   *  space.
   *
   *  @param  dist      extrusion length
   *  @param  up        extrusion direction
   *  @return new DrawSet with extruded element
   */
  public DrawAble extrude(double dist, Vector3D up) {
    if (dist == 0) {
      return this;
    }
    else {
      // -- create a second text --- */
      DrawSet  set       = new DrawSet(CREATE_CONNECTIONS  ?  2+nrLines  :  2);
      set.setLayer(layer);
      set.setColor(color);

      DrawText copy;
      try {
	copy      = (DrawText)this.clone();
      } catch (CloneNotSupportedException x) {
	return this;
      }
      Vector3D extrusion = new Vector3D(dist*up.x, dist*up.y, dist*up.z);
      copy.trafo     = trafo == null  ?  new Matrix4D()  :  new Matrix4D(trafo);
      copy.trafo.translate(extrusion.x, extrusion.y, extrusion.z);
      copy.min       = new Point3D(min.x + extrusion.x,
				   min.y + extrusion.y,
				   min.z + extrusion.z);
      copy.max       = new Point3D(max.x + extrusion.x,
				   max.y + extrusion.y,
				   max.z + extrusion.z);

      set.addDrawable(this);
      set.addDrawable(copy);

      if (CREATE_CONNECTIONS) {
	// --- create connections between the two texts ---
	Matrix4D tmp = new Matrix4D(trafo);

	for (int c = 0;   c < drawChars.length;   c++) {
	  DrawChar ch = drawChars[c];
	  if (ch.lines != null) {
	    for (int l = ch.lines.length - 1;   l >= 0;   l--) {
	      for (int p = ch.lines[l].length - 1;   p >= 0;   p--) {
		Point3D point = ch.lines[l][p];

		DrawLines line = new DrawLines(2);
		line.addPoint(point);
		line.addPoint(point.x + extrusion.x,
			      point.y + extrusion.y,
			      point.z + extrusion.z);
		line.transformBy(tmp);

		line.setLayer(layer);
		line.setColor(color);

		set.addDrawable(line);
	      }
	    }
	  }
	  tmp.translate(drawChars[c].advance, 0, 0);
	}
      }
      return set;
    }
  }

}

class Unicode {
  static final char UCNONE   = 0xffff;

  static final char unicode[][] = {
    {	/* ISO-1 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x007F,

      0x0080,
      0x0081,
      0x0082,
      0x0083,
      0x0084,
      0x0085,
      0x0086,
      0x0087,
      0x0088,
      0x0089,
      0x008A,
      0x008B,
      0x008C,
      0x008D,
      0x008E,
      0x008F,

      0x0090,
      0x0091,
      0x0092,
      0x0093,
      0x0094,
      0x0095,
      0x0096,
      0x0097,
      0x0098,
      0x0099,
      0x009A,
      0x009B,
      0x009C,
      0x009D,
      0x009E,
      0x009F,

      0x00A0,
      0x00A1,
      0x00A2,
      0x00A3,
      0x00A4,
      0x00A5,
      0x00A6,
      0x00A7,
      0x00A8,
      0x00A9,
      0x00AA,
      0x00AB,
      0x00AC,
      0x00AD,
      0x00AE,
      0x00AF,

      0x00B0,
      0x00B1,
      0x00B2,
      0x00B3,
      0x00B4,
      0x00B5,
      0x00B6,
      0x00B7,
      0x00B8,
      0x00B9,
      0x00BA,
      0x00BB,
      0x00BC,
      0x00BD,
      0x00BE,
      0x00BF,

      0x00C0,
      0x00C1,
      0x00C2,
      0x00C3,
      0x00C4,
      0x00C5,
      0x00C6,
      0x00C7,
      0x00C8,
      0x00C9,
      0x00CA,
      0x00CB,
      0x00CC,
      0x00CD,
      0x00CE,
      0x00CF,

      0x00D0,
      0x00D1,
      0x00D2,
      0x00D3,
      0x00D4,
      0x00D5,
      0x00D6,
      0x00D7,
      0x00D8,
      0x00D9,
      0x00DA,
      0x00DB,
      0x00DC,
      0x00DD,
      0x00DE,
      0x00DF,

      0x00E0,
      0x00E1,
      0x00E2,
      0x00E3,
      0x00E4,
      0x00E5,
      0x00E6,
      0x00E7,
      0x00E8,
      0x00E9,
      0x00EA,
      0x00EB,
      0x00EC,
      0x00ED,
      0x00EE,
      0x00EF,

      0x00F0,
      0x00F1,
      0x00F2,
      0x00F3,
      0x00F4,
      0x00F5,
      0x00F6,
      0x00F7,
      0x00F8,
      0x00F9,
      0x00FA,
      0x00FB,
      0x00FC,
      0x00FD,
      0x00FE,
      0x00FF
    },
    {	/* ISO-2 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x007F,

      0x0080,
      0x0081,
      0x0082,
      0x0083,
      0x0084,
      0x0085,
      0x0086,
      0x0087,
      0x0088,
      0x0089,
      0x008A,
      0x008B,
      0x008C,
      0x008D,
      0x008E,
      0x008F,

      0x0090,
      0x0091,
      0x0092,
      0x0093,
      0x0094,
      0x0095,
      0x0096,
      0x0097,
      0x0098,
      0x0099,
      0x009A,
      0x009B,
      0x009C,
      0x009D,
      0x009E,
      0x009F,

      0x00A0,
      0x0104,
      0x02D8,
      0x0141,
      0x00A4,
      0x013D,
      0x015A,
      0x00A7,
      0x00A8,
      0x0160,
      0x015E,
      0x0164,
      0x0179,
      0x00AD,
      0x017D,
      0x017B,

      0x00B0,
      0x0105,
      0x02DB,
      0x0142,
      0x00B4,
      0x013E,
      0x015B,
      0x02C7,
      0x00B8,
      0x0161,
      0x015F,
      0x0165,
      0x017A,
      0x02DD,
      0x017E,
      0x017C,

      0x0154,
      0x00C1,
      0x00C2,
      0x0102,
      0x00C4,
      0x0139,
      0x0106,
      0x00C7,
      0x010C,
      0x00C9,
      0x0118,
      0x00CB,
      0x011A,
      0x00CD,
      0x00CE,
      0x010E,

      0x0110,
      0x0143,
      0x0147,
      0x00D3,
      0x00D4,
      0x0150,
      0x00D6,
      0x00D7,
      0x0158,
      0x016E,
      0x00DA,
      0x0170,
      0x00DC,
      0x00DD,
      0x0162,
      0x00DF,

      0x0155,
      0x00E1,
      0x00E2,
      0x0103,
      0x00E4,
      0x013A,
      0x0107,
      0x00E7,
      0x010D,
      0x00E9,
      0x0119,
      0x00EB,
      0x011B,
      0x00ED,
      0x00EE,
      0x010F,

      0x0111,
      0x0144,
      0x0148,
      0x00F3,
      0x00F4,
      0x0151,
      0x00F6,
      0x00F7,
      0x0159,
      0x016F,
      0x00FA,
      0x0171,
      0x00FC,
      0x00FD,
      0x0163,
      0x02D9
    },
    {	/* DOS437 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x2302,

      0x00C7,
      0x00FC,
      0x00E9,
      0x00E2,
      0x00E4,
      0x00E0,
      0x00E5,
      0x00E7,
      0x00EA,
      0x00EB,
      0x00E8,
      0x00EF,
      0x00EE,
      0x00EC,
      0x00C4,
      0x00C5,

      0x00C9,
      0x00E6,
      0x00C6,
      0x00F4,
      0x00F6,
      0x00F2,
      0x00FB,
      0x00F9,
      0x00FF,
      0x00D6,
      0x00DC,
      0x00A2,
      0x00A3,
      0x00A5,
      0x20A7,
      0x0192,

      0x00E1,
      0x00ED,
      0x00F3,
      0x00FA,
      0x00F1,
      0x00D1,
      0x00AA,
      0x00BA,
      0x00BF,
      0x2310,
      0x00AC,
      0x00BD,
      0x00BC,
      0x00A1,
      0x00AB,
      0x00BB,

      0x2591,
      0x2592,
      0x2593,
      0x2502,
      0x2524,
      0x2561,
      0x2562,
      0x2556,
      0x2555,
      0x2563,
      0x2551,
      0x2557,
      0x255D,
      0x255C,
      0x255B,
      0x2510,

      0x2514,
      0x2534,
      0x252C,
      0x251C,
      0x2500,
      0x253C,
      0x255E,
      0x255F,
      0x255A,
      0x2554,
      0x2569,
      0x2566,
      0x2560,
      0x2550,
      0x256C,
      0x2567,

      0x2568,
      0x2564,
      0x2565,
      0x2559,
      0x2558,
      0x2552,
      0x2553,
      0x256B,
      0x256A,
      0x2518,
      0x250C,
      0x2588,
      0x2584,
      0x258C,
      0x2590,
      0x2580,

      0x03B1,
      0x00DF,
      0x0393,
      0x03C0,
      0x03A3,
      0x03C3,
      0x00B5,
      0x03C4,
      0x03A6,
      0x0398,
      0x03A9,
      0x03B4,
      0x221E,
      0x03C6,
      0x03B5,
      0x2229,

      0x2261,
      0x00B1,
      0x2265,
      0x2264,
      0x2320,
      0x2321,
      0x00F7,
      0x2248,
      0x00B0,
      0x2219,
      0x00B7,
      0x221A,
      0x207F,
      0x00B2,
      0x25A0,
      0x00A0
    },
    {	/* DOS850 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x2302,

      0x00C7,
      0x00FC,
      0x00E9,
      0x00E2,
      0x00E4,
      0x00E0,
      0x00E5,
      0x00E7,
      0x00EA,
      0x00EB,
      0x00E8,
      0x00EF,
      0x00EE,
      0x00EC,
      0x00C4,
      0x00C5,

      0x00C9,
      0x00E6,
      0x00C6,
      0x00F4,
      0x00F6,
      0x00F2,
      0x00FB,
      0x00F9,
      0x00FF,
      0x00D6,
      0x00DC,
      0x00F8,
      0x00A3,
      0x00D8,
      0x00D7,
      0x0192,

      0x00E1,
      0x00ED,
      0x00F3,
      0x00FA,
      0x00F1,
      0x00D1,
      0x00AA,
      0x00BA,
      0x00BF,
      0x00AE,
      0x00AC,
      0x00BD,
      0x00BC,
      0x00A1,
      0x00AB,
      0x00BB,

      0x2591,
      0x2592,
      0x2593,
      0x2502,
      0x2524,
      0x00C1,
      0x00C2,
      0x00C0,
      0x00A9,
      0x2563,
      0x2551,
      0x2557,
      0x255D,
      0x00A2,
      0x00A5,
      0x2510,

      0x2514,
      0x2534,
      0x252C,
      0x251C,
      0x2500,
      0x253C,
      0x00E3,
      0x00C3,
      0x255A,
      0x2554,
      0x2569,
      0x2566,
      0x2560,
      0x2550,
      0x256C,
      0x00A4,

      0x00F0,
      0x00D0,
      0x00CA,
      0x00CB,
      0x00C8,
      0x0131,
      0x00CD,
      0x00CE,
      0x00CF,
      0x2518,
      0x250C,
      0x2588,
      0x2584,
      0x00A6,
      0x00CC,
      0x2580,

      0x00D3,
      0x00DF,
      0x00D4,
      0x00D2,
      0x00F5,
      0x00D5,
      0x00B5,
      0x00FE,
      0x00DE,
      0x00DA,
      0x00DB,
      0x00D9,
      0x00FD,
      0x00DD,
      0x00AF,
      0x00B4,

      0x00AD,
      0x00B1,
      0x2017,
      0x00BE,
      0x00B6,
      0x00A7,
      0x00F7,
      0x00B8,
      0x00B0,
      0x00A8,
      0x00B7,
      0x00B9,
      0x00B3,
      0x00B2,
      0x25A0,
      0x00A0
    },
    {	/* DOS852 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x2302,

      0x00C7,
      0x00FC,
      0x00E9,
      0x00E2,
      0x00E4,
      0x016F,
      0x0107,
      0x00E7,
      0x0142,
      0x00EB,
      0x0150,
      0x0151,
      0x00EE,
      0x0179,
      0x00C4,
      0x0106,

      0x00C9,
      0x0139,
      0x013A,
      0x00F4,
      0x00F6,
      0x013D,
      0x013E,
      0x015A,
      0x015B,
      0x00D6,
      0x00DC,
      0x0164,
      0x0165,
      0x0141,
      0x00D7,
      0x010D,

      0x00E1,
      0x00ED,
      0x00F3,
      0x00FA,
      0x0104,
      0x0105,
      0x017D,
      0x017E,
      0x0118,
      0x0119,
      0x00AC,
      0x017A,
      0x010C,
      0x015F,
      0x00AB,
      0x00BB,

      0x2591,
      0x2592,
      0x2593,
      0x2502,
      0x2524,
      0x00C1,
      0x00C2,
      0x011A,
      0x015E,
      0x2563,
      0x2551,
      0x2557,
      0x255D,
      0x017B,
      0x017C,
      0x2510,

      0x2514,
      0x2534,
      0x252C,
      0x251C,
      0x2500,
      0x253C,
      0x0102,
      0x0103,
      0x255A,
      0x2554,
      0x2569,
      0x2566,
      0x2560,
      0x2550,
      0x256C,
      0x00A4,

      0x0111,
      0x0110,
      0x010E,
      0x00CB,
      0x010F,
      0x0147,
      0x00CD,
      0x00CE,
      0x011B,
      0x2518,
      0x250C,
      0x2588,
      0x2584,
      0x0162,
      0x016E,
      0x2580,

      0x00D3,
      0x00DF,
      0x00D4,
      0x0143,
      0x0144,
      0x0148,
      0x0160,
      0x0161,
      0x0154,
      0x00DA,
      0x0155,
      0x0170,
      0x00FD,
      0x00DD,
      0x0163,
      0x00B4,

      0x00AD,
      0x02DD,
      0x02DB,
      0x02C7,
      0x02D8,
      0x00A7,
      0x00F7,
      0x00B8,
      0x00B0,
      0x00A8,
      0x02D9,
      0x0171,
      0x0158,
      0x0159,
      0x25A0,
      0x00A0
    },
    {	/* DOS855 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x2302,

      0x0452,
      0x0402,
      0x0453,
      0x0403,
      0x0451,
      0x0401,
      0x0454,
      0x0404,
      0x0455,
      0x0405,
      0x0456,
      0x0406,
      0x0457,
      0x0407,
      0x0456,
      0x0408,

      0x0459,
      0x0409,
      0x045A,
      0x040A,
      0x045B,
      0x040B,
      0x045C,
      0x040C,
      0x045E,
      0x040E,
      0x045F,
      0x040F,
      0x044E,
      0x042E,
      0x044A,
      0x042A,

      0x0430,
      0x0410,
      0x0431,
      0x0411,
      0x0446,
      0x0426,
      0x0434,
      0x0414,
      0x0435,
      0x0415,
      0x0444,
      0x0424,
      0x0433,
      0x0413,
      0x00AB,
      0x00BB,

      0x2591,
      0x2592,
      0x2593,
      0x2502,
      0x2524,
      0x0445,
      0x0425,
      0x0438,
      0x0418,
      0x2563,
      0x2551,
      0x2557,
      0x255D,
      0x0439,
      0x0419,
      0x2510,

      0x2514,
      0x2534,
      0x252C,
      0x251C,
      0x2500,
      0x253C,
      0x043A,
      0x041A,
      0x255A,
      0x2554,
      0x2569,
      0x2566,
      0x2560,
      0x2550,
      0x256C,
      0x00A4,

      0x043B,
      0x041B,
      0x043C,
      0x041C,
      0x043D,
      0x041D,
      0x043E,
      0x041E,
      0x043F,
      0x2518,
      0x250C,
      0x2588,
      0x2584,
      0x041F,
      0x044F,
      0x2580,

      0x042F,
      0x0440,
      0x0420,
      0x0441,
      0x0421,
      0x0442,
      0x0422,
      0x0443,
      0x0423,
      0x0436,
      0x0416,
      0x0432,
      0x0412,
      0x044C,
      0x042C,
      0x2116,

      0x00AD,
      0x044B,
      0x042B,
      0x0437,
      0x0417,
      0x0448,
      0x0428,
      0x044D,
      0x042D,
      0x0449,
      0x0429,
      0x0447,
      0x0427,
      UCNONE,
      0x25A0,
      0x00A0
    },
    {	/* DOS857 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x2302,

      0x00C7,
      0x00FC,
      0x00E9,
      0x00E2,
      0x00E4,
      0x00E0,
      0x00E5,
      0x00E7,
      0x00EA,
      0x00EB,
      0x00E8,
      0x00EF,
      0x00EE,
      0x0131,
      0x00C4,
      0x00C5,

      0x00C9,
      0x00E6,
      0x00C6,
      0x00F4,
      0x00F6,
      0x00F2,
      0x00FB,
      0x00F9,
      0x0130,
      0x00D6,
      0x00DC,
      0x00F8,
      0x00A3,
      0x00D8,
      0x015E,
      0x015F,

      0x00E1,
      0x00ED,
      0x00F3,
      0x00FA,
      0x00F1,
      0x00D1,
      0x011E,
      0x011F,
      0x00BF,
      0x00AE,
      0x00AC,
      0x00BD,
      0x00BC,
      0x00A1,
      0x00AB,
      0x00BB,

      0x2591,
      0x2592,
      0x2593,
      0x2502,
      0x2524,
      0x00C1,
      0x00C2,
      0x00C0,
      0x00A9,
      0x2563,
      0x2551,
      0x2557,
      0x255D,
      0x00A2,
      0x00A5,
      0x2510,

      0x2514,
      0x2534,
      0x252C,
      0x251C,
      0x2500,
      0x253C,
      0x00E3,
      0x00C3,
      0x255A,
      0x2554,
      0x2569,
      0x2566,
      0x2560,
      0x2550,
      0x256C,
      0x00A4,

      0x00BA,
      0x00AA,
      0x00CA,
      0x00CB,
      0x00C8,
      UCNONE,
      0x00CD,
      0x00CE,
      0x00CF,
      0x2518,
      0x250C,
      0x2588,
      0x2584,
      0x00A6,
      0x00CC,
      0x2580,

      0x00D3,
      0x00DF,
      0x00D4,
      0x00D2,
      0x00F5,
      0x00D5,
      0x00B5,
      UCNONE,
      0x00D7,
      0x00DA,
      0x00DB,
      0x00D9,
      0x00EC,
      0x00FF,
      0x00AF,
      0x00B4,

      0x00AD,
      0x00B1,
      UCNONE,
      0x00BE,
      0x00B6,
      0x00A7,
      0x00F7,
      0x00B8,
      0x00B0,
      0x00A8,
      0x00B7,
      0x00B9,
      0x00B3,
      0x00B2,
      0x25A0,
      0x00A0
    },
    {	/* DOS860 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x2302,

      0x00C7,
      0x00FC,
      0x00E9,
      0x00E2,
      0x00E3,
      0x00E0,
      0x00C1,
      0x00E7,
      0x00EA,
      0x00CA,
      0x00E8,
      0x00CD,
      0x00D4,
      0x00EC,
      0x00C3,
      0x00C2,

      0x00C9,
      0x00C0,
      0x00C8,
      0x00F4,
      0x00F5,
      0x00F2,
      0x00DA,
      0x00F9,
      0x00CC,
      0x00D5,
      0x00DC,
      0x00A2,
      0x00A3,
      0x00D9,
      0x20A7,
      0x00D3,

      0x00E1,
      0x00ED,
      0x00F3,
      0x00FA,
      0x00F1,
      0x00D1,
      0x00AA,
      0x00BA,
      0x00BF,
      0x00D2,
      0x00AC,
      0x00BD,
      0x00BC,
      0x00A1,
      0x00AB,
      0x00BB,

      0x2591,
      0x2592,
      0x2593,
      0x2502,
      0x2524,
      0x2561,
      0x2562,
      0x2556,
      0x2555,
      0x2563,
      0x2551,
      0x2557,
      0x255D,
      0x255C,
      0x255B,
      0x2510,

      0x2514,
      0x2534,
      0x252C,
      0x251C,
      0x2500,
      0x253C,
      0x255E,
      0x255F,
      0x255A,
      0x2554,
      0x2569,
      0x2566,
      0x2560,
      0x2550,
      0x256C,
      0x2567,

      0x2568,
      0x2564,
      0x2565,
      0x2559,
      0x2558,
      0x2552,
      0x2553,
      0x256B,
      0x256A,
      0x2518,
      0x250C,
      0x2588,
      0x2584,
      0x258C,
      0x2590,
      0x2580,

      0x03B1,
      0x00DF,
      0x0393,
      0x03C0,
      0x03A3,
      0x03C3,
      0x00B5,
      0x03C4,
      0x03A6,
      0x0398,
      0x03A9,
      0x03B4,
      0x221E,
      0x03C6,
      0x03B5,
      0x2229,

      0x2261,
      0x00B1,
      0x2265,
      0x2264,
      0x2320,
      0x2321,
      0x00F7,
      0x2248,
      0x00B0,
      0x2219,
      0x00B7,
      0x221A,
      0x207F,
      0x00B2,
      0x25A0,
      0x00A0
    },
    {	/* DOS861 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x2302,

      0x00C7,
      0x00FC,
      0x00E9,
      0x00E2,
      0x00E3,
      0x00E0,
      0x00E5,
      0x00E7,
      0x00EA,
      0x00EB,
      0x00E8,
      0x00D0,
      0x00F0,
      0x00DE,
      0x00C4,
      0x00C5,

      0x00C9,
      0x00E6,
      0x00C6,
      0x00F4,
      0x00F6,
      0x00FE,
      0x00FB,
      0x00DD,
      0x00FD,
      0x00D6,
      0x00DC,
      0x00F8,
      0x00A3,
      0x00D8,
      0x20A7,
      0x0192,

      0x00E1,
      0x00ED,
      0x00F3,
      0x00FA,
      0x00C1,
      0x00CD,
      0x00D3,
      0x00DA,
      0x00BF,
      0x2310,
      0x00AC,
      0x00BD,
      0x00BC,
      0x00A1,
      0x00AB,
      0x00BB,

      0x2591,
      0x2592,
      0x2593,
      0x2502,
      0x2524,
      0x2561,
      0x2562,
      0x2556,
      0x2555,
      0x2563,
      0x2551,
      0x2557,
      0x255D,
      0x255C,
      0x255B,
      0x2510,

      0x2514,
      0x2534,
      0x252C,
      0x251C,
      0x2500,
      0x253C,
      0x255E,
      0x255F,
      0x255A,
      0x2554,
      0x2569,
      0x2566,
      0x2560,
      0x2550,
      0x256C,
      0x2567,

      0x2568,
      0x2564,
      0x2565,
      0x2559,
      0x2558,
      0x2552,
      0x2553,
      0x256B,
      0x256A,
      0x2518,
      0x250C,
      0x2588,
      0x2584,
      0x258C,
      0x2590,
      0x2580,

      0x03B1,
      0x00DF,
      0x0393,
      0x03C0,
      0x03A3,
      0x03C3,
      0x00B5,
      0x03C4,
      0x03A6,
      0x0398,
      0x03A9,
      0x03B4,
      0x221E,
      0x03C6,
      0x03B5,
      0x2229,

      0x2261,
      0x00B1,
      0x2265,
      0x2264,
      0x2320,
      0x2321,
      0x00F7,
      0x2248,
      0x00B0,
      0x2219,
      0x00B7,
      0x221A,
      0x207F,
      0x00B2,
      0x25A0,
      0x00A0
    },
    {	/* DOS863 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x2302,

      0x00C7,
      0x00FC,
      0x00E9,
      0x00E2,
      0x00E3,
      0x00E0,
      0x00B6,
      0x00E7,
      0x00EA,
      0x00EB,
      0x00E8,
      0x00EF,
      0x00EE,
      0x2017,
      0x00C0,
      0x00A7,

      0x00C9,
      0x00C8,
      0x00CA,
      0x00F4,
      0x00CB,
      0x00CF,
      0x00FB,
      0x00F9,
      0x00A4,
      0x00D4,
      0x00DC,
      0x00A2,
      0x00A3,
      0x00D9,
      0x00DB,
      0x0192,

      0x00A6,
      0x00B4,
      0x00F3,
      0x00FA,
      0x00A8,
      0x00B8,
      0x00B3,
      0x00AF,
      0x00CE,
      0x2310,
      0x00AC,
      0x00BD,
      0x00BC,
      0x00BE,
      0x00AB,
      0x00BB,

      0x2591,
      0x2592,
      0x2593,
      0x2502,
      0x2524,
      0x2561,
      0x2562,
      0x2556,
      0x2555,
      0x2563,
      0x2551,
      0x2557,
      0x255D,
      0x255C,
      0x255B,
      0x2510,

      0x2514,
      0x2534,
      0x252C,
      0x251C,
      0x2500,
      0x253C,
      0x255E,
      0x255F,
      0x255A,
      0x2554,
      0x2569,
      0x2566,
      0x2560,
      0x2550,
      0x256C,
      0x2567,

      0x2568,
      0x2564,
      0x2565,
      0x2559,
      0x2558,
      0x2552,
      0x2553,
      0x256B,
      0x256A,
      0x2518,
      0x250C,
      0x2588,
      0x2584,
      0x258C,
      0x2590,
      0x2580,

      0x03B1,
      0x00DF,
      0x0393,
      0x03C0,
      0x03A3,
      0x03C3,
      0x00B5,
      0x03C4,
      0x03A6,
      0x0398,
      0x03A9,
      0x03B4,
      0x221E,
      0x03C6,
      0x03B5,
      0x2229,

      0x2261,
      0x00B1,
      0x2265,
      0x2264,
      0x2320,
      0x2321,
      0x00F7,
      0x2248,
      0x00B0,
      0x2219,
      0x00B7,
      0x221A,
      0x207F,
      0x00B2,
      0x25A0,
      0x00A0
    },
    {	/* DOS864 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x2302,

      0x00B0,
      0x00B7,
      0x2219,
      0x221A,
      0x2592,
      0x2500,
      0x2502,
      0x253C,
      0x2524,
      0x252C,
      0x251C,
      0x2534,
      0x2510,
      0x250C,
      0x2514,
      0x2518,

      0x03B2,
      0x221E,
      0x03C6,
      0x00B1,
      0x00BD,
      0x00BC,
      0x2248,
      0x00AB,
      0x00BB,
      0xFEF7,
      0xFEF8,
      UCNONE,
      UCNONE,
      0xFEFB,
      0xFEFC,
      UCNONE,

      0x00A0,
      0x00AD,
      0xFE82,
      0x00A3,
      0x00A4,
      0xFE84,
      UCNONE,
      UCNONE,
      0xFE8E,
      0xFE8F,
      0xFE95,
      0xFE99,
      0x060C,
      0xFE9D,
      0xFEA1,
      0xFEA5,

      0x0660,
      0x0661,
      0x0662,
      0x0663,
      0x0664,
      0x0665,
      0x0666,
      0x0667,
      0x0668,
      0x0669,
      0xFED1,
      0x061B,
      0xFEB1,
      0xFEB5,
      0xFEB9,
      0x061F,

      0x00A2,
      0xFE80,
      0xFE81,
      0xFE83,
      0xFE85,
      0xFECC,
      0xFE8A,
      0xFE8D,
      0xFE90,
      0xFE93,
      0xFE96,
      0xFE9A,
      0xFE9E,
      0xFEA2,
      0xFEA6,
      0xFEA9,

      0xFEAB,
      0xFEAD,
      0xFEAF,
      0xFEB2,
      0xFEB6,
      0xFEBA,
      0xFEBE,
      0xFEC1,
      0xFEC5,
      0xFECA,
      0xFECE,
      0x00A6,
      0x00AC,
      0x00F7,
      0x00D7,
      0xFEC9,

      0x0640,
      0xFED2,
      0xFED6,
      0xFEDA,
      0xFEDE,
      0xFEE2,
      0xFEE6,
      0xFEEA,
      0xFEED,
      0xFEEF,
      0xFEF2,
      0xFEBD,
      0xFECB,
      0xFED0,
      0xFECD,
      0xFEE1,

      0xFE7D,
      0x0651,
      0xFEE5,
      0xFEE9,
      0xFEEB,
      0xFEF0,
      0xFEF4,
      0xFECF,
      0xFED5,
      0xFEF5,
      0xFEF6,
      0xFEDD,
      0xFED9,
      0xFEF1,
      0x25A0,
      UCNONE
    },
    {	/* DOS865 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x2302,

      0x00C7,
      0x00FC,
      0x00E9,
      0x00E2,
      0x00E4,
      0x00E0,
      0x00B5,
      0x00E7,
      0x00EA,
      0x00EB,
      0x00E8,
      0x00EF,
      0x00EE,
      0x00EC,
      0x00C4,
      0x00C5,

      0x00C9,
      0x00E6,
      0x00C6,
      0x00F4,
      0x00F6,
      0x00F2,
      0x00FB,
      0x00F9,
      0x00FF,
      0x00D6,
      0x00DC,
      0x00F8,
      0x00A3,
      0x00D8,
      0x20A7,
      0x0192,

      0x00E1,
      0x00ED,
      0x00F3,
      0x00FA,
      0x00F1,
      0x00D1,
      0x00AA,
      0x00BA,
      0x00BF,
      0x2310,
      0x00AC,
      0x00BD,
      0x00BC,
      0x00A1,
      0x00AB,
      0x00A4,

      0x2591,
      0x2592,
      0x2593,
      0x2502,
      0x2524,
      0x2561,
      0x2562,
      0x2556,
      0x2555,
      0x2563,
      0x2551,
      0x2557,
      0x255D,
      0x255C,
      0x255B,
      0x2510,

      0x2514,
      0x2534,
      0x252C,
      0x251C,
      0x2500,
      0x253C,
      0x255E,
      0x255F,
      0x255A,
      0x2554,
      0x2569,
      0x2566,
      0x2560,
      0x2550,
      0x256C,
      0x2567,

      0x2568,
      0x2564,
      0x2565,
      0x2559,
      0x2558,
      0x2552,
      0x2553,
      0x256B,
      0x256A,
      0x2518,
      0x250C,
      0x2588,
      0x2584,
      0x258C,
      0x2590,
      0x2580,

      0x03B1,
      0x00DF,
      0x0393,
      0x03C0,
      0x03A3,
      0x03C3,
      0x00B5,
      0x03C4,
      0x03A6,
      0x0398,
      0x03A9,
      0x03B4,
      0x221E,
      0x03C6,
      0x03B5,
      0x2229,

      0x2261,
      0x00B1,
      0x2265,
      0x2264,
      0x2320,
      0x2321,
      0x00F7,
      0x2248,
      0x00B0,
      0x2219,
      0x00B7,
      0x221A,
      0x207F,
      0x00B2,
      0x25A0,
      0x00A0
    },
    {	/* DOS869 */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x2302,

      UCNONE,
      UCNONE,
      UCNONE,
      UCNONE,
      UCNONE,
      UCNONE,
      0x0386,
      UCNONE,
      0X00B7,
      0x00AC,
      0x00A6,
      0x2018,
      0x2019,
      0x0388,
      0x2015,
      0x0389,

      0x038A,
      0x03AA,
      0x038C,
      UCNONE,
      UCNONE,
      0x038E,
      0x03AB,
      0x00A9,
      0x038F,
      0x00B2,
      0x00B3,
      0x03AC,
      0x00A3,
      0x03AD,
      0x03AE,
      0x03AF,

      0x03CA,
      0x0390,
      0x03CC,
      0x03CD,
      0x0391,
      0x0392,
      0x0393,
      0x0394,
      0x0395,
      0x0396,
      0x0397,
      0x00BD,
      0x0398,
      0x0399,
      0x00AB,
      0x00BB,

      0x2591,
      0x2592,
      0x2593,
      0x2502,
      0x2524,
      0x039A,
      0x039B,
      0x039C,
      0x039D,
      0x2563,
      0x2551,
      0x2557,
      0x255D,
      0x039E,
      0x039F,
      0x2510,

      0x2514,
      0x2534,
      0x252C,
      0x251C,
      0x2500,
      0x253C,
      0x03A0,
      0x03A1,
      0x255A,
      0x2554,
      0x2569,
      0x2566,
      0x2560,
      0x2550,
      0x256C,
      0x03A3,

      0x03A4,
      0x03A5,
      0x03A6,
      0x03A7,
      0x03A8,
      0x03A9,
      0x03B1,
      0x03B2,
      0x03B3,
      0x2518,
      0x250C,
      0x2588,
      0x2584,
      0x03B4,
      0x03B5,
      0x2580,

      0x03B6,
      0x03B7,
      0x03B8,
      0x03B9,
      0x03BA,
      0x03BB,
      0x03BC,
      0x03BD,
      0x03BE,
      0x03BF,
      0x03C0,
      0x03C1,
      0x03C3,
      0x03C2,
      0x03C4,
      0x00B4,

      0x00AD,
      0x00B1,
      0x03C5,
      0x03C6,
      0x03C7,
      0x00A7,
      0x03C8,
      0x03F4,
      0x00B0,
      0x00A8,
      0x03C9,
      0x03CB,
      0x03B0,
      0x03CE,
      0x25A0,
      0x00A0
    },
    {	/* MAC */
      0x0000,
      0x0001,
      0x0002,
      0x0003,
      0x0004,
      0x0005,
      0x0006,
      0x0007,
      0x0008,
      0x0009,
      0x000A,
      0x000B,
      0x000C,
      0x000D,
      0x000E,
      0x000F,

      0x0010,
      0x0011,
      0x0012,
      0x0013,
      0x0014,
      0x0015,
      0x0016,
      0x0017,
      0x0018,
      0x0019,
      0x001A,
      0x001B,
      0x001C,
      0x001D,
      0x001E,
      0x001F,

      0x0020,
      0x0021,
      0x0022,
      0x0023,
      0x0024,
      0x0025,
      0x0026,
      0x0027,
      0x0028,
      0x0029,
      0x002A,
      0x002B,
      0x002C,
      0x002D,
      0x002E,
      0x002F,

      0x0030,
      0x0031,
      0x0032,
      0x0033,
      0x0034,
      0x0035,
      0x0036,
      0x0037,
      0x0038,
      0x0039,
      0x003A,
      0x003B,
      0x003C,
      0x003D,
      0x003E,
      0x003F,

      0x0040,
      0x0041,
      0x0042,
      0x0043,
      0x0044,
      0x0045,
      0x0046,
      0x0047,
      0x0048,
      0x0049,
      0x004A,
      0x004B,
      0x004C,
      0x004D,
      0x004E,
      0x004F,

      0x0050,
      0x0051,
      0x0052,
      0x0053,
      0x0054,
      0x0055,
      0x0056,
      0x0057,
      0x0058,
      0x0059,
      0x005A,
      0x005B,
      0x005C,
      0x005D,
      0x005E,
      0x005F,

      0x0060,
      0x0061,
      0x0062,
      0x0063,
      0x0064,
      0x0065,
      0x0066,
      0x0067,
      0x0068,
      0x0069,
      0x006A,
      0x006B,
      0x006C,
      0x006D,
      0x006E,
      0x006F,

      0x0070,
      0x0071,
      0x0072,
      0x0073,
      0x0074,
      0x0075,
      0x0076,
      0x0077,
      0x0078,
      0x0079,
      0x007A,
      0x007B,
      0x007C,
      0x007D,
      0x007E,
      0x007F,

      0x00C4,
      0x00C5,
      0x00C7,
      0x00C9,
      0x00D1,
      0x00D6,
      0x00DC,
      0x00E1,
      0x00E0,
      0x00E2,
      0x00E4,
      0x00E3,
      0x00E5,
      0x00E7,
      0x00E9,
      0x00E8,

      0x00EA,
      0x00EB,
      0x00ED,
      0x00EC,
      0x00EE,
      0x00EF,
      0x00F1,
      0x00F3,
      0x00F2,
      0x00F4,
      0x00F6,
      0x00F5,
      0x00FA,
      0x00F9,
      0x00FB,
      0x00FC,

      0x2020,
      0x00B0,
      0x00A2,
      0x00A3,
      0x00A7,
      0x2022,
      0x00B6,
      0x00DF,
      0x00AE,
      0x00A9,
      0x2122,
      0x00B4,
      0x00A8,
      0x2260,
      0x00C6,
      0x00D8,

      0x221E,
      0x00B1,
      0x2264,
      0x2265,
      0x00A5,
      0x00B5,
      0x2202,
      0x2211,
      0x220F,
      0x03C0,
      0x222B,
      0x00AA,
      0x00BA,
      0x2126,
      0x00E6,
      0x00F8,

      0x00BF,
      0x00A1,
      0x00AC,
      0x221A,
      0x0192,
      0x2248,
      0x2206,
      0x00AB,
      0x00BB,
      0x2026,
      0x00A0,
      0x00C0,
      0x00C3,
      0x00D5,
      0x0152,
      0x0153,

      0x2010,
      0x2014,
      0x201C,
      0x201D,
      0x2018,
      0x2019,
      0x00F7,
      0x25CA,
      0x00FF,
      0x0178,
      0x2044,
      0x00A4,
      0x2039,
      0x203A,
      0x0066,
      0x0066,

      0x2021,
      0x00B7,
      0x201A,
      0x201E,
      0x2030,
      0x00C2,
      0x00CA,
      0x00C1,
      0x00CB,
      0x00C8,
      0x00CD,
      0x00CE,
      0x00CF,
      0x00CC,
      0x00D3,
      0x00D4,

      0xFDFF,
      0x00D2,
      0x00DA,
      0x00DB,
      0x00D9,
      0x0131,
      0x02C6,
      0x02DC,
      0x00AF,
      0x02D8,
      0x02D9,
      0x02DA,
      0x00B8,
      0x02DD,
      0x02DB,
      0x02C7
    },
  };

  static char[] unicode2DOS437;


  static String char2DOS437(StringBuffer str, int codePage, char unknown) {
    if (unicode2DOS437 == null) {
      // --- initialize ---
      unicode2DOS437 = new char[0x10000]; // uh oh: 128k
      for (int c = 0;   c < DxfFont.NUM_CHARS;   c++) {
	char c2;
	if ((c2 = unicode[DxfHeader.UC_DOS437][c]) != UCNONE) {
	  unicode2DOS437[c2] = (char)c;
	}
      }
    }

    if (codePage != DxfHeader.UC_DOS437) {
      StringBuffer buf = new StringBuffer(str.length());

      for (int c = 0;  c < str.length();   c++) {
	char c2 = unicode2DOS437[str.charAt(c)];
	buf.append(c2 != 0  ?  c2  :  unknown);
      }

      return new String(buf);
    }
    else {
      return new String(str);
    }
  }

}
